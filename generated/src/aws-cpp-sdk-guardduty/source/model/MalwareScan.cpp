/**
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0.
 */

#include <aws/core/utils/json/JsonSerializer.h>
#include <aws/guardduty/model/MalwareScan.h>

#include <utility>

using namespace Aws::Utils::Json;
using namespace Aws::Utils;

namespace Aws {
namespace GuardDuty {
namespace Model {

MalwareScan::MalwareScan(JsonView jsonValue) { *this = jsonValue; }

MalwareScan& MalwareScan::operator=(JsonView jsonValue) {
  if (jsonValue.ValueExists("resourceArn")) {
    m_resourceArn = jsonValue.GetString("resourceArn");
    m_resourceArnHasBeenSet = true;
  }
  if (jsonValue.ValueExists("resourceType")) {
    m_resourceType = MalwareProtectionResourceTypeMapper::GetMalwareProtectionResourceTypeForName(jsonValue.GetString("resourceType"));
    m_resourceTypeHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanId")) {
    m_scanId = jsonValue.GetString("scanId");
    m_scanIdHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanStatus")) {
    m_scanStatus = MalwareProtectionScanStatusMapper::GetMalwareProtectionScanStatusForName(jsonValue.GetString("scanStatus"));
    m_scanStatusHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanResultStatus")) {
    m_scanResultStatus = ScanResultStatusMapper::GetScanResultStatusForName(jsonValue.GetString("scanResultStatus"));
    m_scanResultStatusHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanType")) {
    m_scanType = MalwareProtectionScanTypeMapper::GetMalwareProtectionScanTypeForName(jsonValue.GetString("scanType"));
    m_scanTypeHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanStartedAt")) {
    m_scanStartedAt = jsonValue.GetDouble("scanStartedAt");
    m_scanStartedAtHasBeenSet = true;
  }
  if (jsonValue.ValueExists("scanCompletedAt")) {
    m_scanCompletedAt = jsonValue.GetDouble("scanCompletedAt");
    m_scanCompletedAtHasBeenSet = true;
  }
  return *this;
}

JsonValue MalwareScan::Jsonize() const {
  JsonValue payload;

  if (m_resourceArnHasBeenSet) {
    payload.WithString("resourceArn", m_resourceArn);
  }

  if (m_resourceTypeHasBeenSet) {
    payload.WithString("resourceType", MalwareProtectionResourceTypeMapper::GetNameForMalwareProtectionResourceType(m_resourceType));
  }

  if (m_scanIdHasBeenSet) {
    payload.WithString("scanId", m_scanId);
  }

  if (m_scanStatusHasBeenSet) {
    payload.WithString("scanStatus", MalwareProtectionScanStatusMapper::GetNameForMalwareProtectionScanStatus(m_scanStatus));
  }

  if (m_scanResultStatusHasBeenSet) {
    payload.WithString("scanResultStatus", ScanResultStatusMapper::GetNameForScanResultStatus(m_scanResultStatus));
  }

  if (m_scanTypeHasBeenSet) {
    payload.WithString("scanType", MalwareProtectionScanTypeMapper::GetNameForMalwareProtectionScanType(m_scanType));
  }

  if (m_scanStartedAtHasBeenSet) {
    payload.WithDouble("scanStartedAt", m_scanStartedAt.SecondsWithMSPrecision());
  }

  if (m_scanCompletedAtHasBeenSet) {
    payload.WithDouble("scanCompletedAt", m_scanCompletedAt.SecondsWithMSPrecision());
  }

  return payload;
}

}  // namespace Model
}  // namespace GuardDuty
}  // namespace Aws
