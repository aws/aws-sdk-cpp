/**
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0.
 */

#include <aws/core/utils/json/JsonSerializer.h>
#include <aws/guardduty/model/GetMalwareScanResultDetails.h>

#include <utility>

using namespace Aws::Utils::Json;
using namespace Aws::Utils;

namespace Aws {
namespace GuardDuty {
namespace Model {

GetMalwareScanResultDetails::GetMalwareScanResultDetails(JsonView jsonValue) { *this = jsonValue; }

GetMalwareScanResultDetails& GetMalwareScanResultDetails::operator=(JsonView jsonValue) {
  if (jsonValue.ValueExists("scanResultStatus")) {
    m_scanResultStatus = ScanResultStatusMapper::GetScanResultStatusForName(jsonValue.GetString("scanResultStatus"));
    m_scanResultStatusHasBeenSet = true;
  }
  if (jsonValue.ValueExists("skippedFileCount")) {
    m_skippedFileCount = jsonValue.GetInt64("skippedFileCount");
    m_skippedFileCountHasBeenSet = true;
  }
  if (jsonValue.ValueExists("failedFileCount")) {
    m_failedFileCount = jsonValue.GetInt64("failedFileCount");
    m_failedFileCountHasBeenSet = true;
  }
  if (jsonValue.ValueExists("threatFoundFileCount")) {
    m_threatFoundFileCount = jsonValue.GetInt64("threatFoundFileCount");
    m_threatFoundFileCountHasBeenSet = true;
  }
  if (jsonValue.ValueExists("totalFileCount")) {
    m_totalFileCount = jsonValue.GetInt64("totalFileCount");
    m_totalFileCountHasBeenSet = true;
  }
  if (jsonValue.ValueExists("totalBytes")) {
    m_totalBytes = jsonValue.GetInt64("totalBytes");
    m_totalBytesHasBeenSet = true;
  }
  if (jsonValue.ValueExists("uniqueThreatCount")) {
    m_uniqueThreatCount = jsonValue.GetInt64("uniqueThreatCount");
    m_uniqueThreatCountHasBeenSet = true;
  }
  if (jsonValue.ValueExists("threats")) {
    Aws::Utils::Array<JsonView> threatsJsonList = jsonValue.GetArray("threats");
    for (unsigned threatsIndex = 0; threatsIndex < threatsJsonList.GetLength(); ++threatsIndex) {
      m_threats.push_back(threatsJsonList[threatsIndex].AsObject());
    }
    m_threatsHasBeenSet = true;
  }
  return *this;
}

JsonValue GetMalwareScanResultDetails::Jsonize() const {
  JsonValue payload;

  if (m_scanResultStatusHasBeenSet) {
    payload.WithString("scanResultStatus", ScanResultStatusMapper::GetNameForScanResultStatus(m_scanResultStatus));
  }

  if (m_skippedFileCountHasBeenSet) {
    payload.WithInt64("skippedFileCount", m_skippedFileCount);
  }

  if (m_failedFileCountHasBeenSet) {
    payload.WithInt64("failedFileCount", m_failedFileCount);
  }

  if (m_threatFoundFileCountHasBeenSet) {
    payload.WithInt64("threatFoundFileCount", m_threatFoundFileCount);
  }

  if (m_totalFileCountHasBeenSet) {
    payload.WithInt64("totalFileCount", m_totalFileCount);
  }

  if (m_totalBytesHasBeenSet) {
    payload.WithInt64("totalBytes", m_totalBytes);
  }

  if (m_uniqueThreatCountHasBeenSet) {
    payload.WithInt64("uniqueThreatCount", m_uniqueThreatCount);
  }

  if (m_threatsHasBeenSet) {
    Aws::Utils::Array<JsonValue> threatsJsonList(m_threats.size());
    for (unsigned threatsIndex = 0; threatsIndex < threatsJsonList.GetLength(); ++threatsIndex) {
      threatsJsonList[threatsIndex].AsObject(m_threats[threatsIndex].Jsonize());
    }
    payload.WithArray("threats", std::move(threatsJsonList));
  }

  return payload;
}

}  // namespace Model
}  // namespace GuardDuty
}  // namespace Aws
